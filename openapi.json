openapi: 3.1.0
info:
  title: MirroraX Intelligence API
  version: 1.0.0
  description: >
    Provides live market, social, and intelligence data for the MirroraX GPT â€”
    including Fusion, Alpha Signals, and system health endpoints.
servers:
  - url: https://mirrorx-backend.onrender.com

paths:
  /healthz:
    get:
      operationId: getHealthz
      summary: Check system health
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok: { type: boolean }
                required: [ok]
                additionalProperties: true
              example:
                ok: true

  /api/status:
    get:
      operationId: getStatus
      summary: Get unified MirrorX system status
      description: Returns overall MirrorX system health, endpoint availability, and uptime signal.
      responses:
        "200":
          description: System health snapshot
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SystemStatus"

  /api/crypto/solana:
    get:
      operationId: getCryptoSolana
      summary: Fetch Solana ecosystem market data
      description: Live Solana token metrics and trending pairs.
      responses:
        "200":
          description: Solana token list and metrics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CryptoSolanaResponse"

  /api/fusion/market-intel:
    get:
      operationId: getFusionMarketIntel
      summary: Fetch Fusion market intel
      description: Unified Fusion endpoint returning market + ecosystem + social data.
      responses:
        "200":
          description: Fusion market intel payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FusionMarketIntelResponse"

  /api/intel/summary:
    get:
      operationId: getIntelSummary
      summary: Fetch summarized intelligence data
      description: Lightweight snapshot combining CoinMarketCap + CryptoCompare + Solana trending + Twitter activity.
      responses:
        "200":
          description: Summarized market and social intelligence
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IntelSummaryResponse"

  /api/intel/full:
    get:
      operationId: getIntelFull
      summary: Fetch full intelligence dataset
      description: Deep dataset merging all social + market intelligence streams.
      responses:
        "200":
          description: Full market and social intelligence payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IntelFullResponse"

  /api/twitterRapid/likes:
    get:
      operationId: getTwitterRapidLikes
      summary: Fetch Twitter likes using RapidAPI
      parameters:
        - name: pid
          in: query
          required: false
          description: Twitter post ID (defaults to mirrorx_trending)
          schema:
            type: string
        - name: count
          in: query
          required: false
          description: Number of likes to retrieve (defaults to 10)
          schema:
            type: integer
            minimum: 1
      responses:
        "200":
          description: Likes payload from RapidAPI or mirror source
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TwitterLikesResponse"

  /api/signals/alpha:
    get:
      operationId: getAlphaSignals
      summary: Get ranked MirrorX alpha signals
      description: Aggregates liquidity, momentum, sentiment, and social metrics into top ranked alpha opportunities.
      responses:
        "200":
          description: Ranked alpha signal list
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaSignalResponse"

  /api/signals/history:
    get:
      operationId: getSignalHistory
      summary: Get alpha signal history
      description: Returns stored historical snapshots of previous alpha signal calculations for trend and performance analysis.
      responses:
        "200":
          description: Array of historical signal snapshots
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaSignalHistory"

  /api/signals/trends:
    get:
      operationId: getSignalTrends
      summary: Analyze MirrorX alpha signal trends
      description: Identifies emerging and fading tokens by comparing historical alpha signal snapshots.
      responses:
        "200":
          description: List of emerging and fading tokens
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaTrendResponse"

components:
  schemas:
    SystemStatus:
      type: object
      properties:
        system: { type: string }
        overall_status: { type: string }
        healthy_services:
          type: array
          items: { type: string }
        degraded_services:
          type: array
          items: { type: string }
        endpoint_results:
          type: object
          properties: {}
          additionalProperties: true
        uptime_signal: { type: number }
      additionalProperties: true

    CryptoSolanaToken:
      type: object
      properties:
        symbol: { type: string }
        name: { type: string }
      additionalProperties: true

    CryptoSolanaResponse:
      type: object
      properties:
        updated: { type: string }
        ecosystem: { type: string }
        count: { type: integer }
        tokens:
          type: array
          items:
            $ref: "#/components/schemas/CryptoSolanaToken"
      additionalProperties: true

    FusionMarketIntelResponse:
      type: object
      properties:
        system: { type: string }
        status: { type: string }
        updated_at:
          type: string
          format: date-time
        data:
          type: object
          properties:
            solana:
              type: object
              properties:
                tokens:
                  type: array
                  items:
                    $ref: "#/components/schemas/CryptoSolanaToken"
              additionalProperties: true
            market:
              type: object
              properties:
                narrative: { type: string }
              additionalProperties: true
            social:
              type: object
              properties:
                narrative: { type: string }
              additionalProperties: true
          additionalProperties: true
      additionalProperties: true

    IntelSummaryMarketItem:
      type: object
      properties:
        symbol: { type: string }
        name: { type: string }
        price: { type: number }
        volume24h: { type: number }
        change24h: { type: number }
      additionalProperties: true

    IntelSummaryResponse:
      type: object
      properties:
        updated: { type: string }
        marketSnapshot:
          type: array
          items:
            $ref: "#/components/schemas/IntelSummaryMarketItem"
        solanaTrending:
          type: array
          items:
            type: object
            properties: {}
            additionalProperties: true
        social:
          type: object
          properties:
            topTwitterMentions:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
          additionalProperties: true
      additionalProperties: true

    IntelFullResponse:
      type: object
      properties:
        updated: { type: string }
        market:
          type: object
          properties:
            solana:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
            coinmarketcap:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
            compare:
              type: object
              properties: {}
              additionalProperties: true
          additionalProperties: true
        social:
          type: object
          properties:
            twitter:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
            discord:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
            telegram:
              type: array
              items:
                type: object
                properties: {}
                additionalProperties: true
          additionalProperties: true
      additionalProperties: true

    TwitterLikesUser:
      type: object
      properties:
        username: { type: string }
      additionalProperties: true

    TwitterLikesResponse:
      type: object
      properties:
        postId: { type: string }
        likesCount: { type: integer }
        users:
          type: array
          items:
            $ref: "#/components/schemas/TwitterLikesUser"
      additionalProperties: true

    AlphaSignal:
      type: object
      properties:
        symbol: { type: string }
        alpha_score: { type: number }
        liquidity_usd: { type: number }
        volume_24h: { type: number }
        price_change_24h: { type: number }
        sentiment: { type: number }
        social_boost: { type: number }
      additionalProperties: true

    AlphaSignalResponse:
      type: object
      properties:
        system: { type: string }
        status: { type: string }
        total_tokens_scanned: { type: integer }
        top_signals:
          type: array
          items:
            $ref: "#/components/schemas/AlphaSignal"
      additionalProperties: true

    AlphaSignalSnapshot:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        data:
          type: object
          properties:
            top_signals:
              type: array
              items:
                $ref: "#/components/schemas/AlphaSignal"
          additionalProperties: true
      additionalProperties: true

    AlphaSignalHistory:
      type: object
      properties:
        records:
          type: array
          items:
            $ref: "#/components/schemas/AlphaSignalSnapshot"
      additionalProperties: true

    AlphaTrendItem:
      type: object
      properties:
        symbol: { type: string }
        change: { type: number }
        momentum: { type: string }
        trend_pct: { type: string }
      additionalProperties: true

    AlphaTrendResponse:
      type: object
      properties:
        system: { type: string }
        status: { type: string }
        timestamp:
          type: string
          format: date-time
        records_analyzed: { type: integer }
        emerging:
          type: array
          items:
            $ref: "#/components/schemas/AlphaTrendItem"
        fading:
          type: array
          items:
            $ref: "#/components/schemas/AlphaTrendItem"
      additionalProperties: true
