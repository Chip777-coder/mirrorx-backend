openapi: 3.1.0
info:
  title: MirroraX Intelligence + DexScreener Actions API
  version: 1.0.0
  description: >
    MirrorX backend endpoints (Fusion/Intel/Signals/Health) plus optional direct DexScreener endpoints.
    Also includes an optional Telegram "send alert" endpoint you can add to your Flask app to let the GPT
    trigger Telegram pushes explicitly (recommended for clean integration).

servers:
  - url: https://mirrorx-backend.onrender.com
    description: MirrorX Backend (Render)
  - url: https://api.dexscreener.com
    description: DexScreener Public API

paths:
  /healthz:
    get:
      operationId: getHealthz
      summary: Check system health
      responses:
        "200":
          description: Health status
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                required: [ok]
                additionalProperties: true

  /api/status:
    get:
      operationId: getStatus
      summary: Get unified MirrorX system status
      description: Status aggregation of key MirrorX endpoints.
      responses:
        "200":
          description: System health snapshot
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SystemStatus"

  /api/fusion/market-intel:
    get:
      operationId: getFusionMarketIntel
      summary: Fetch Fusion market intel
      description: Unified Fusion endpoint returning market + ecosystem + social data.
      parameters:
        - name: search
          in: query
          required: false
          description: Optional token/pair search query (forwarded to DexScreener search logic in your backend).
          schema:
            type: string
      responses:
        "200":
          description: Fusion market intel payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/FusionMarketIntelResponse"

  /api/crypto/solana:
    get:
      operationId: getCryptoSolana
      summary: Fetch Solana ecosystem market data
      description: Live Solana token metrics and trending pairs (your backend route).
      responses:
        "200":
          description: Solana token list and metrics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CryptoSolanaResponse"

  /api/intel/summary:
    get:
      operationId: getIntelSummary
      summary: Fetch summarized intelligence data
      description: Lightweight snapshot combining market + social sources.
      responses:
        "200":
          description: Summarized market and social intelligence
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IntelSummaryResponse"

  /api/intel/full:
    get:
      operationId: getIntelFull
      summary: Fetch full intelligence dataset
      description: Deep dataset merging all social + market intelligence streams.
      responses:
        "200":
          description: Full market and social intelligence payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/IntelFullResponse"

  /api/twitterRapid/likes:
    get:
      operationId: getTwitterRapidLikes
      summary: Fetch Twitter likes using RapidAPI
      parameters:
        - name: pid
          in: query
          required: false
          description: Twitter post ID (defaults to mirrorx_trending in your code)
          schema:
            type: string
        - name: count
          in: query
          required: false
          description: Number of likes to retrieve (defaults to 10)
          schema:
            type: integer
            minimum: 1
      responses:
        "200":
          description: Likes payload
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TwitterLikesResponse"

  /api/signals/alpha:
    get:
      operationId: getAlphaSignals
      summary: Get ranked MirrorX alpha signals
      responses:
        "200":
          description: Ranked alpha signal list
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaSignalResponse"

  /api/signals/history:
    get:
      operationId: getSignalHistory
      summary: Get alpha signal history
      responses:
        "200":
          description: Historical alpha signal snapshots
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaSignalHistory"

  /api/signals/trends:
    get:
      operationId: getSignalTrends
      summary: Analyze MirrorX alpha signal trends
      responses:
        "200":
          description: Emerging and fading tokens
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlphaTrendResponse"

  # ---------------------------
  # Optional: Telegram send endpoint (add this to Flask if you want GPT-triggered alerts)
  # ---------------------------
  /api/alerts/telegram/send:
    post:
      operationId: sendTelegramAlert
      summary: Send a Telegram alert message (MirrorX backend)
      description: >
        Optional endpoint. Implement it in Flask to allow explicit Telegram pushes from the GPT.
        This is cleaner than relying only on background threads.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TelegramSendRequest"
      responses:
        "200":
          description: Sent
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TelegramSendResponse"

  # ---------------------------
  # DexScreener (direct) endpoints â€” from your reference list
  # Note: these use the DexScreener server above.
  # ---------------------------
  /token-profiles/latest/v1:
    get:
      operationId: getDexTokenProfiles
      summary: DexScreener token profiles (latest)
      responses:
        "200":
          description: Array of token profiles
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: true

  /community-takeovers/latest/v1:
    get:
      operationId: getDexCommunityTakeovers
      summary: DexScreener community takeovers (latest)
      responses:
        "200":
          description: Array of community takeovers
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: true

  /ads/latest/v1:
    get:
      operationId: getDexAds
      summary: DexScreener ads (latest)
      responses:
        "200":
          description: Array of ads
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: true

  /token-boosts/latest/v1:
    get:
      operationId: getDexTokenBoostsLatest
      summary: DexScreener token boosts (latest)
      responses:
        "200":
          description: Array of boosts
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: true

  /token-boosts/top/v1:
    get:
      operationId: getDexTokenBoostsTop
      summary: DexScreener token boosts (top)
      responses:
        "200":
          description: Array of top boosts
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  additionalProperties: true

  /orders/v1/{chainId}/{tokenAddress}:
    get:
      operationId: getDexOrders
      summary: DexScreener orders
      parameters:
        - name: chainId
          in: path
          required: true
          schema: { type: string }
        - name: tokenAddress
          in: path
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Orders response
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true

  /latest/dex/pairs/{chainId}/{pairId}:
    get:
      operationId: getDexPair
      summary: DexScreener pair by chain and pairId
      parameters:
        - name: chainId
          in: path
          required: true
          schema: { type: string }
        - name: pairId
          in: path
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Pair response
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true

  /latest/dex/search:
    get:
      operationId: searchDex
      summary: DexScreener search
      parameters:
        - name: q
          in: query
          required: true
          schema: { type: string }
          description: Search query (symbol/pair)
      responses:
        "200":
          description: Search results
          content:
            application/json:
              schema:
                type: object
                properties:
                  pairs:
                    type: array
                    items:
                      type: object
                      additionalProperties: true
                additionalProperties: true

  /token-pairs/v1/{chainId}/{tokenAddress}:
    get:
      operationId: getDexTokenPairs
      summary: DexScreener token pairs by chain and token address
      parameters:
        - name: chainId
          in: path
          required: true
          schema: { type: string }
        - name: tokenAddress
          in: path
          required: true
          schema: { type: string }
      responses:
        "200":
          description: Token pairs response
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true

  /tokens/v1/{chainId}/{tokenAddresses}:
    get:
      operationId: getDexTokens
      summary: DexScreener tokens by chain and tokenAddresses (comma-separated)
      parameters:
        - name: chainId
          in: path
          required: true
          schema: { type: string }
        - name: tokenAddresses
          in: path
          required: true
          schema: { type: string }
          description: Comma-separated token addresses
      responses:
        "200":
          description: Tokens response
          content:
            application/json:
              schema:
                type: object
                additionalProperties: true

components:
  schemas:
    SystemStatus:
      type: object
      properties:
        system: { type: string }
        overall_status: { type: string }
        healthy_services:
          type: array
          items: { type: string }
        degraded_services:
          type: array
          items: { type: string }
        endpoint_results:
          type: object
          additionalProperties: true
        uptime_signal: { type: number }
      additionalProperties: true

    CryptoSolanaToken:
      type: object
      properties:
        symbol: { type: string }
        name: { type: string }
      additionalProperties: true

    CryptoSolanaResponse:
      type: object
      properties:
        updated: { type: string }
        ecosystem: { type: string }
        count: { type: integer }
        tokens:
          type: array
          items:
            $ref: "#/components/schemas/CryptoSolanaToken"
      additionalProperties: true

    FusionMarketIntelResponse:
      type: object
      properties:
        updated: { type: string }
        data:
          type: array
          items:
            type: object
            additionalProperties: true
      additionalProperties: true

    IntelSummaryResponse:
      type: object
      properties:
        updated: { type: string }
        marketSnapshot:
          type: array
          items:
            type: object
            additionalProperties: true
        solanaTrending:
          type: array
          items:
            type: object
            additionalProperties: true
        social:
          type: object
          additionalProperties: true
      additionalProperties: true

    IntelFullResponse:
      type: object
      properties:
        updated: { type: string }
        market:
          type: object
          additionalProperties: true
        social:
          type: object
          additionalProperties: true
      additionalProperties: true

    TwitterLikesResponse:
      type: object
      additionalProperties: true

    AlphaSignalResponse:
      type: object
      additionalProperties: true

    AlphaSignalHistory:
      type: object
      additionalProperties: true

    AlphaTrendResponse:
      type: object
      additionalProperties: true

    TelegramSendRequest:
      type: object
      properties:
        text:
          type: string
          description: Message to send to Telegram
        parse_mode:
          type: string
          description: Telegram parse mode (e.g., Markdown or HTML)
          enum: [Markdown, HTML]
      required: [text]
      additionalProperties: false

    TelegramSendResponse:
      type: object
      properties:
        ok: { type: boolean }
        detail: { type: string }
      required: [ok]
      additionalProperties: true
